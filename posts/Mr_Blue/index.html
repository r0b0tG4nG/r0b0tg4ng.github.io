<!DOCTYPE html><html lang="en" mode="dark" ><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"><meta name="day-prompt" content="days ago"><meta name="hour-prompt" content="hours ago"><meta name="minute-prompt" content="minutes ago"><meta name="justnow-prompt" content="just now"><meta name="generator" content="Jekyll v4.3.2" /><meta property="og:title" content="Mr Blue Writeup PwnTillDawn" /><meta name="author" content="r0b0tG4nG" /><meta property="og:locale" content="en" /><meta name="description" content="&gt; Information Gathering The Default nmap scan showed many active ports on the target. We can see some major ports like 80 (http), 445 (smb) &amp; 3389 (rdp). The target is running an outdated version of windows Windows Server 2008 R2 Enterprise 7601." /><meta property="og:description" content="&gt; Information Gathering The Default nmap scan showed many active ports on the target. We can see some major ports like 80 (http), 445 (smb) &amp; 3389 (rdp). The target is running an outdated version of windows Windows Server 2008 R2 Enterprise 7601." /><link rel="canonical" href="https://r0b0tg4ng.github.io//posts/Mr_Blue/" /><meta property="og:url" content="https://r0b0tg4ng.github.io//posts/Mr_Blue/" /><meta property="og:site_name" content="r0b0tG4nG" /><meta property="og:type" content="article" /><meta property="article:published_time" content="2021-11-28T03:33:00+00:00" /><meta name="twitter:card" content="summary" /><meta property="twitter:title" content="Mr Blue Writeup PwnTillDawn" /><meta name="twitter:site" content="@r0b0tg4ng" /><meta name="twitter:creator" content="@r0b0tG4nG" /><meta name="google-site-verification" content="google_meta_tag_verification" /> <script type="application/ld+json"> {"@context":"https://schema.org","@type":"BlogPosting","author":{"@type":"Person","name":"r0b0tG4nG"},"dateModified":"2021-11-29T18:51:57+00:00","datePublished":"2021-11-28T03:33:00+00:00","description":"&gt; Information Gathering The Default nmap scan showed many active ports on the target. We can see some major ports like 80 (http), 445 (smb) &amp; 3389 (rdp). The target is running an outdated version of windows Windows Server 2008 R2 Enterprise 7601.","headline":"Mr Blue Writeup PwnTillDawn","mainEntityOfPage":{"@type":"WebPage","@id":"https://r0b0tg4ng.github.io//posts/Mr_Blue/"},"url":"https://r0b0tg4ng.github.io//posts/Mr_Blue/"}</script><title>Mr Blue Writeup PwnTillDawn | r0b0tG4nG</title><link rel="apple-touch-icon" sizes="180x180" href="/assets/img/favicons/apple-touch-icon.png"><link rel="icon" type="image/png" sizes="32x32" href="/assets/img/favicons/favicon-32x32.png"><link rel="icon" type="image/png" sizes="16x16" href="/assets/img/favicons/favicon-16x16.png"><link rel="manifest" href="/assets/img/favicons/site.webmanifest"><link rel="shortcut icon" href="/assets/img/favicons/favicon.ico"><meta name="apple-mobile-web-app-title" content="r0b0tG4nG"><meta name="application-name" content="r0b0tG4nG"><meta name="msapplication-TileColor" content="#da532c"><meta name="msapplication-config" content="/assets/img/favicons/browserconfig.xml"><meta name="theme-color" content="#ffffff"><link rel="preconnect" href="https://fonts.gstatic.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://fonts.gstatic.com"><link rel="preconnect" href="https://www.google-analytics.com" crossorigin="use-credentials"><link rel="dns-prefetch" href="https://www.google-analytics.com"><link rel="preconnect" href="https://www.googletagmanager.com" crossorigin="anonymous"><link rel="dns-prefetch" href="https://www.googletagmanager.com"><link rel="preconnect" href="https://cdn.jsdelivr.net"><link rel="dns-prefetch" href="https://cdn.jsdelivr.net"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap@4.0.0/dist/css/bootstrap.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/@fortawesome/fontawesome-free@5.11.2/css/all.min.css"><link rel="stylesheet" href="/assets/css/style.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/gh/afeld/bootstrap-toc@1.0.1/dist/bootstrap-toc.min.css"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/magnific-popup@1.1.0/dist/magnific-popup.min.css"> <script src="https://cdn.jsdelivr.net/npm/jquery@3/dist/jquery.min.js"></script><body data-spy="scroll" data-target="#toc"><div id="sidebar" class="d-flex flex-column align-items-end" lang="en"><div class="profile-wrapper text-center"><div id="avatar"> <a href="/" alt="avatar" class="mx-auto"> <img src="https://avatars.githubusercontent.com/u/67085453?v=4" alt="avatar" onerror="this.style.display='none'"> </a></div><div class="site-title mt-3"> <a href="/">r0b0tG4nG</a></div><div class="site-subtitle font-italic">The Regular IT Guy <br> | OSCP | OSWA | eCCPTv2 | eWPT</div></div><ul class="w-100"><li class="nav-item"> <a href="/" class="nav-link"> <i class="fa-fw fas fa-home ml-xl-3 mr-xl-3 unloaded"></i> <span>HOME</span> </a><li class="nav-item"> <a href="/categories/" class="nav-link"> <i class="fa-fw fas fa-stream ml-xl-3 mr-xl-3 unloaded"></i> <span>CATEGORIES</span> </a><li class="nav-item"> <a href="/tags/" class="nav-link"> <i class="fa-fw fas fa-tag ml-xl-3 mr-xl-3 unloaded"></i> <span>TAGS</span> </a><li class="nav-item"> <a href="/archives/" class="nav-link"> <i class="fa-fw fas fa-archive ml-xl-3 mr-xl-3 unloaded"></i> <span>ARCHIVES</span> </a><li class="nav-item"> <a href="/about/" class="nav-link"> <i class="fa-fw fas fa-info-circle ml-xl-3 mr-xl-3 unloaded"></i> <span>ABOUT</span> </a></ul><div class="sidebar-bottom mt-auto d-flex flex-wrap justify-content-center align-items-center"> <a href="https://github.com/r0b0tG4nG" aria-label="github" target="_blank" rel="noopener"> <i class="fab fa-github"></i> </a> <a href="https://twitter.com/r0b0tg4ng" aria-label="twitter" target="_blank" rel="noopener"> <i class="fab fa-twitter"></i> </a> <a href="https://www.youtube.com/channel/UCSY-pfwuYspZFlRsO7vBfIQ" aria-label="youtube" > <i class="fab fa-youtube"></i> </a> <a href="" aria-label="rss" > <i class="fas fa-rss"></i> </a></div></div><div id="topbar-wrapper" class="row justify-content-center topbar-down"><div id="topbar" class="col-11 d-flex h-100 align-items-center justify-content-between"> <span id="breadcrumb"> <span> <a href="/"> Home </a> </span> <span>Mr Blue Writeup PwnTillDawn</span> </span> <i id="sidebar-trigger" class="fas fa-bars fa-fw"></i><div id="topbar-title"> Post</div><i id="search-trigger" class="fas fa-search fa-fw"></i> <span id="search-wrapper" class="align-items-center"> <i class="fas fa-search fa-fw"></i> <input class="form-control" id="search-input" type="search" aria-label="search" autocomplete="off" placeholder="Search..."> <i class="fa fa-times-circle fa-fw" id="search-cleaner"></i> </span> <span id="search-cancel" >Cancel</span></div></div><div id="main-wrapper"><div id="main"><div class="row"><div id="post-wrapper" class="col-12 col-lg-11 col-xl-8"><div class="post pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><h1 data-toc-skip>Mr Blue Writeup PwnTillDawn</h1><div class="post-meta text-muted d-flex flex-column"><div> <span class="semi-bold"> r0b0tG4nG </span> on <span class="timeago " data-toggle="tooltip" data-placement="bottom" title="Sun, Nov 28, 2021, 3:33 AM +0000" >Nov 28, 2021<i class="unloaded">2021-11-28T03:33:00+00:00</i> </span></div><div> <span> Updated <span class="timeago lastmod" data-toggle="tooltip" data-placement="bottom" title="Mon, Nov 29, 2021, 6:51 PM +0000" >Nov 29, 2021<i class="unloaded">2021-11-29T18:51:57+00:00</i> </span> </span> <span class="readtime" data-toggle="tooltip" data-placement="bottom" title="255 words">1 min read</span></div></div><div class="post-content"><p><img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/143767874-42418165-32f2-4f22-87eb-1dbeb2e14f67.png" alt="image" /><br /><br /> <strong>&gt; Information Gathering</strong><br /> The Default nmap scan showed many active ports on the target. We can see some major ports like 80 (http), 445 (smb) &amp; 3389 (rdp). The target is running an outdated version of windows <code class="language-plaintext highlighter-rouge">Windows Server 2008 R2 Enterprise 7601</code>. <br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/143767867-9a7e797d-a7ad-40b8-a1c9-f05c69f9c3aa.png" alt="image" /><br /></p><p>Nmap has its scripting engine. To find vulnerabilities on this target, lets run nmap scan against the target invoking some <em>NSE (nmap scripting engine)</em> arguments. This type os scan will identify vulnerabilities on the target.<br /> <code class="language-plaintext highlighter-rouge">nmap --script=vuln,exploit 10.150.150.242</code><br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/143767883-cad14ba0-8348-4b41-a2a0-edea0c8b1083.png" alt="image" /><br /></p><p>While waiting for the <code class="language-plaintext highlighter-rouge">NSE</code> scan to complete, let’s take a look at what webapp runs on the port 80. It looks like a static html website.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/143767889-658a16a7-4161-4d54-a730-417a35472180.png" alt="image" /></p><p>From the NSE scan, we can see that the target is vulnerable to <code class="language-plaintext highlighter-rouge">ms17-010</code> with an impact of remote code execution. This vulnerability is popularly known as <code class="language-plaintext highlighter-rouge">eternalblue</code>. Since We know the vulnerability, a quick google will lead us to the right exploit.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/143767903-032954a0-9abf-4d22-bdff-297c3819a179.png" alt="image" /><br /></p><p>We found an approved exploit from <a href="https://www.rapid7.com/db/modules/exploit/windows/smb/ms17_010_eternalblue/">rapid7</a>. This exploit will corrupt the windows kernels using the smb protocol continuously until triggered.<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/143767914-7f0e5960-d91c-4b15-8ca7-51e0cd7fe814.png" alt="image" /><br /></p><p>The next step is to start <code class="language-plaintext highlighter-rouge">msfconsole</code> load the module <code class="language-plaintext highlighter-rouge">use exploit/windows/smb/ms17_010_eternalblue</code> and fill the required options for this exploit to function. The required options are <code class="language-plaintext highlighter-rouge">RHOSTS</code> (Target IP), <code class="language-plaintext highlighter-rouge">RPORT</code> (Target port) &amp; <code class="language-plaintext highlighter-rouge">LHOST</code>(Your Tun0 IP).<br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/143767919-f0d35b38-2f2d-45f9-8fdd-bf94461db7ee.png" alt="image" /><br /></p><p>After setting the required options for this module to work, we can fire the exploit against the target using either <code class="language-plaintext highlighter-rouge">run</code> or <code class="language-plaintext highlighter-rouge">exploit</code> command. Wait for a few seconds for the exploit to run and when completed, you will have a <code class="language-plaintext highlighter-rouge">meterpreter shell</code> <br /> <img data-proofer-ignore data-src="https://user-images.githubusercontent.com/67085453/143767965-71d0f83b-b4f7-48a1-bc02-ef2bad8b0ecc.png" alt="image" /></p><p>Reference: <a href="https://online.pwntilldawn.com/">PwnTillDawn Online battlefield</a></p></div><div class="post-tail-wrapper text-muted"><div class="post-meta mb-3"> <i class="far fa-folder-open fa-fw mr-1"></i> <a href='/categories/blogging/'>Blogging</a>, <a href='/categories/pwntilldawn/'>PwnTillDawn</a></div><div class="post-tags"> <i class="fa fa-tags fa-fw mr-1"></i> <a href="/tags/writeups/" class="post-tag no-text-decoration" >writeups</a> <a href="/tags/eternalblue/" class="post-tag no-text-decoration" >eternalblue</a> <a href="/tags/ms17-010/" class="post-tag no-text-decoration" >ms17-010</a> <a href="/tags/metasploit/" class="post-tag no-text-decoration" >metasploit</a> <a href="/tags/nmap/" class="post-tag no-text-decoration" >nmap</a> <a href="/tags/mr-blue/" class="post-tag no-text-decoration" >mr blue</a></div><div class="post-tail-bottom d-flex justify-content-between align-items-center mt-3 pt-5 pb-2"><div class="license-wrapper"> This post is licensed under <a href="https://creativecommons.org/licenses/by/4.0/"> CC BY 4.0 </a> by the author.</div><div class="share-wrapper"> <span class="share-label text-muted mr-1">Share</span> <span class="share-icons"> <a href="https://twitter.com/intent/tweet?text=Mr Blue Writeup PwnTillDawn - r0b0tG4nG&url=https://r0b0tg4ng.github.io//posts/Mr_Blue/" data-toggle="tooltip" data-placement="top" title="Twitter" target="_blank" rel="noopener" aria-label="Twitter"> <i class="fa-fw fab fa-twitter"></i> </a> <a href="https://www.facebook.com/sharer/sharer.php?title=Mr Blue Writeup PwnTillDawn - r0b0tG4nG&u=https://r0b0tg4ng.github.io//posts/Mr_Blue/" data-toggle="tooltip" data-placement="top" title="Facebook" target="_blank" rel="noopener" aria-label="Facebook"> <i class="fa-fw fab fa-facebook-square"></i> </a> <a href="https://telegram.me/share?text=Mr Blue Writeup PwnTillDawn - r0b0tG4nG&url=https://r0b0tg4ng.github.io//posts/Mr_Blue/" data-toggle="tooltip" data-placement="top" title="Telegram" target="_blank" rel="noopener" aria-label="Telegram"> <i class="fa-fw fab fa-telegram"></i> </a> <i id="copy-link" class="fa-fw fas fa-link small" data-toggle="tooltip" data-placement="top" title="Copy link" title-succeed="Link copied successfully!"> </i> </span></div></div></div></div></div><div id="panel-wrapper" class="col-xl-3 pl-2 text-muted topbar-down"><div class="access"><div id="access-lastmod" class="post"> <span>Recent Update</span><ul class="post-content pl-0 pb-1 ml-1 mt-2"><li><a href="/posts/OSWA/">My OSWA Journey - New Age Begins</a><li><a href="/posts/Mssql-Jobs/">Manual SQLi On MSSQL [ Creating Jobs With Mssql ]</a><li><a href="/posts/OSCP/">My OSCP Journey - The Untold Story</a><li><a href="/posts/Exploiting-Jfrog-Artifactory/">Exploiting Jfrog Artifactory [ Server-side Request Forgery ]</a><li><a href="/posts/Exploiting-RocketChat/">Exploiting RocketChat [ Message Dump To RCE ]</a></ul></div><div id="access-tags"> <span>Trending Tags</span><div class="d-flex flex-wrap mt-3 mb-1 mr-3"> <a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/exploit-db/">exploit-db</a> <a class="post-tag" href="/tags/hydra/">hydra</a> <a class="post-tag" href="/tags/burpsuite/">burpsuite</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/xp-cmdshell/">xp_cmdshell</a> <a class="post-tag" href="/tags/echoctf/">EchoCTF</a> <a class="post-tag" href="/tags/hack-the-box/">Hack the box</a> <a class="post-tag" href="/tags/impacket-mssqlclient/">impacket-mssqlclient</a> <a class="post-tag" href="/tags/msfconsole/">msfconsole</a></div></div></div></div></div><div class="row"><div class="col-12 col-lg-11 col-xl-8"><div id="post-extend-wrapper" class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-md-4 pr-md-4"><div id="related-posts" class="mt-5 mb-2 mb-sm-4"><h3 class="pt-2 mt-1 mb-4 ml-1" data-toc-skip>Further Reading</h3><div class="card-deck mb-4"><div class="card"> <a href="/posts/Kerberoasting-Using-Mssql-Server/"><div class="card-body"> <span class="timeago small" >Jan 13, 2022<i class="unloaded">2022-01-13T13:33:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Kerberoasting Using Mssql Server [ Abusing GenericAll ]</h3><div class="text-muted small"><p> &gt; Information Gathering From The previous writeup on Abusing MSSQL Linked Servers, we found credentials on the target. In this chapter, we will look at how we can perform kerberoast attacks ...</p></div></div></a></div><div class="card"> <a href="/posts/Elmariachi-PC/"><div class="card-body"> <span class="timeago small" >Nov 29, 2021<i class="unloaded">2021-11-29T00:00:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Elmariachi-PC Writeup PwnTillDawn</h3><div class="text-muted small"><p> &gt; Information Gathering Fire nmap as usual, and from the scan we can see port 445 (smb), 3389 (rdp) &amp; 60000 (ThinVnc). The first two ports are common on windows environments but the other ...</p></div></div></a></div><div class="card"> <a href="/posts/Stuntman-Mike/"><div class="card-body"> <span class="timeago small" >Nov 29, 2021<i class="unloaded">2021-11-29T13:02:00+00:00</i> </span><h3 class="pt-0 mt-1 mb-3" data-toc-skip>Stuntman Mike Writeup PwnTillDawn</h3><div class="text-muted small"><p> &gt; Information Gathering Is there a way to attack a system without gathering information? As usual we need to fire nmap on the target to find out what ports are open and what services are runni...</p></div></div></a></div></div></div><div class="post-navigation d-flex justify-content-between"> <a href="/posts/Junior-Dev/" class="btn btn-outline-primary" prompt="Older"><p>JuniorDev Writeup PwnTillDawn</p></a> <a href="/posts/Morty/" class="btn btn-outline-primary" prompt="Newer"><p>Morty Writeup PwnTillDawn</p></a></div></div></div></div><footer class="d-flex w-100 justify-content-center"><div class="d-flex justify-content-between align-items-center"><div class="footer-left"><p class="mb-0"> © 2023 <a href="https://twitter.com/r0b0tg4ng">Saeed Bala Ahmed</a>. <span data-toggle="tooltip" data-placement="top" title="Except where otherwise noted, the blog posts on this site are licensed under the Creative Commons Attribution 4.0 International (CC BY 4.0) License by the author.">Some rights reserved.</span></p></div><div class="footer-right"><p class="mb-0"></p></div></div></footer></div><div id="search-result-wrapper" class="d-flex justify-content-center unloaded"><div class="col-12 col-sm-11 post-content"><div id="search-hints"><h4 class="text-muted mb-4">Trending Tags</h4><a class="post-tag" href="/tags/writeups/">writeups</a> <a class="post-tag" href="/tags/exploit-db/">exploit db</a> <a class="post-tag" href="/tags/hydra/">hydra</a> <a class="post-tag" href="/tags/burpsuite/">burpsuite</a> <a class="post-tag" href="/tags/ssh/">ssh</a> <a class="post-tag" href="/tags/xp-cmdshell/">xp_cmdshell</a> <a class="post-tag" href="/tags/echoctf/">EchoCTF</a> <a class="post-tag" href="/tags/hack-the-box/">Hack the box</a> <a class="post-tag" href="/tags/impacket-mssqlclient/">impacket mssqlclient</a> <a class="post-tag" href="/tags/msfconsole/">msfconsole</a></div><div id="search-results" class="d-flex flex-wrap justify-content-center text-muted mt-3"></div></div></div></div><script src="https://cdn.jsdelivr.net/npm/mermaid@8/dist/mermaid.min.js"></script> <script> $(function() { let initTheme = "default"; if ($("html[mode=dark]").length > 0 || ($("html[mode]").length == 0 && window.matchMedia("(prefers-color-scheme: dark)").matches ) ) { initTheme = "dark"; } let mermaidConf = { theme: initTheme /* <default|dark|forest|neutral> */ }; /* Markdown converts to HTML */ $("pre").has("code.language-mermaid").each(function() { let svgCode = $(this).children().html(); $(this).addClass("unloaded"); $(this).after(`<div class=\"mermaid\">${svgCode}</div>`); }); mermaid.initialize(mermaidConf); }); </script><div id="mask"></div><a id="back-to-top" href="#" aria-label="back-to-top" class="btn btn-lg btn-box-shadow" role="button"> <i class="fas fa-angle-up"></i> </a> <script src="https://cdn.jsdelivr.net/npm/simple-jekyll-search@1.10.0/dest/simple-jekyll-search.min.js"></script> <script> SimpleJekyllSearch({ searchInput: document.getElementById('search-input'), resultsContainer: document.getElementById('search-results'), json: '/assets/js/data/search.json', searchResultTemplate: '<div class="pl-1 pr-1 pl-sm-2 pr-sm-2 pl-lg-4 pr-lg-4 pl-xl-0 pr-xl-0"> <a href="{url}">{title}</a><div class="post-meta d-flex flex-column flex-sm-row text-muted mt-1 mb-1"> {categories} {tags}</div><p>{snippet}</p></div>', noResultsText: '<p class="mt-5">Oops! No result founds.</p>', templateMiddleware: function(prop, value, template) { if (prop === 'categories') { if (value === '') { return `${value}`; } else { return `<div class="mr-sm-4"><i class="far fa-folder fa-fw"></i>${value}</div>`; } } if (prop === 'tags') { if (value === '') { return `${value}`; } else { return `<div><i class="fa fa-tag fa-fw"></i>${value}</div>`; } } } }); </script> <script src="https://cdn.jsdelivr.net/combine/npm/lozad/dist/lozad.min.js,npm/magnific-popup@1/dist/jquery.magnific-popup.min.js,npm/clipboard@2/dist/clipboard.min.js"></script> <script defer src="/assets/js/dist/post.min.js"></script> <script> /* see: <https://docs.mathjax.org/en/latest/options/input/tex.html#tex-options> */ MathJax = { tex: { inlineMath: [ /* start/end delimiter pairs for in-line math */ ['$','$'], ['\\(','\\)'] ], displayMath: [ /* start/end delimiter pairs for display math */ ['$$', '$$'], ['\\[', '\\]'] ] } }; </script> <script src="https://polyfill.io/v3/polyfill.min.js?features=es6"></script> <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"> </script> <script src="https://cdn.jsdelivr.net/combine/npm/popper.js@1.16.1,npm/bootstrap@4/dist/js/bootstrap.min.js"></script> <script defer src="/app.js"></script> <script defer src="https://www.googletagmanager.com/gtag/js?id="></script> <script> document.addEventListener("DOMContentLoaded", function(event) { window.dataLayer = window.dataLayer || []; function gtag(){dataLayer.push(arguments);} gtag('js', new Date()); gtag('config', ''); }); </script>
